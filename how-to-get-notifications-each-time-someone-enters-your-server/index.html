<!DOCTYPE html><html lang="en-gb"><head><link rel="stylesheet" href="https://blog.jonthan.xyz/assets/css/prism.css?v=2b0833fe69a354f994abc0868f9566cb"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>How to get notifications each time someone enters your server - blogHez</title><meta name="description" content="Personal Tech Blog - Jonathan Ródenas López"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://blog.jonthan.xyz/how-to-get-notifications-each-time-someone-enters-your-server/"><link rel="alternate" type="application/atom+xml" href="https://blog.jonthan.xyz/feed.xml"><link rel="alternate" type="application/json" href="https://blog.jonthan.xyz/feed.json"><meta property="og:title" content="How to get notifications each time someone enters your server"><meta property="og:image" content="https://blog.jonthan.xyz/media/posts/12/51-Messages-2.jpg"><meta property="og:image:width" content="2000"><meta property="og:image:height" content="2000"><meta property="og:site_name" content="blogHez"><meta property="og:description" content="Personal Tech Blog - Jonathan Ródenas López"><meta property="og:url" content="https://blog.jonthan.xyz/how-to-get-notifications-each-time-someone-enters-your-server/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://blog.jonthan.xyz/assets/css/style.css?v=990415c26c73ec313d2a4df5eef0a1f4"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.jonthan.xyz/how-to-get-notifications-each-time-someone-enters-your-server/"},"headline":"How to get notifications each time someone enters your server","datePublished":"2022-08-27T22:38","dateModified":"2022-08-31T01:26","image":{"@type":"ImageObject","url":"https://blog.jonthan.xyz/media/posts/12/51-Messages-2.jpg","height":2000,"width":2000},"description":"Personal Tech Blog - Jonathan Ródenas López","author":{"@type":"Person","name":"Jonathan Ródenas López","url":"https://blog.jonthan.xyz/jonathan/jonathan-rodenas-lopez/"},"publisher":{"@type":"Organization","name":"Jonathan Ródenas López"}}</script><link rel="stylesheet" href="https://blog.jonthan.xyz/media/plugins/docSearch/docsearch.min.css"></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://blog.jonthan.xyz/">blogHez</a><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><div id="docsearch"></div><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false"><use xlink:href="https://blog.jonthan.xyz/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><figure class="hero__image hero__image--overlay"><img src="https://blog.jonthan.xyz/media/posts/12/51-Messages-2.jpg" srcset="https://blog.jonthan.xyz/media/posts/12/responsive/51-Messages-2-xs.jpg 300w, https://blog.jonthan.xyz/media/posts/12/responsive/51-Messages-2-sm.jpg 480w, https://blog.jonthan.xyz/media/posts/12/responsive/51-Messages-2-md.jpg 768w, https://blog.jonthan.xyz/media/posts/12/responsive/51-Messages-2-lg.jpg 1024w, https://blog.jonthan.xyz/media/posts/12/responsive/51-Messages-2-xl.jpg 1360w, https://blog.jonthan.xyz/media/posts/12/responsive/51-Messages-2-2xl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="2000" width="2000" alt=""><figcaption>Image by storyset on Freepik</figcaption></figure><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2022-08-27T22:38">August 27, 2022</time></div><h1>How to get notifications each time someone enters your server</h1><div class="post__meta post__meta--author"><a href="https://blog.jonthan.xyz/jonathan/jonathan-rodenas-lopez/" class="feed__author">Jonathan Ródenas López</a></div></div></header></div><div class="wrapper post__entry"><h1 id="get-a-notification-on-telegram-or-slack" class="align-center">Get a notification on Telegram or Slack</h1><h2 id="telegram-notificationnbsp">Telegram notification&nbsp;</h2><p>Firstly, create a telegram bot. To create one, you need to contact the BotFather, which is essentially a bot used to create other bots.<br><br>The command you need is /newbot which leads to the following steps to create your bot:</p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.jonthan.xyz/media/posts/12/telegr.png" height="858" width="860" alt="" sizes="100vw" srcset="https://blog.jonthan.xyz/media/posts/12/responsive/telegr-xs.png 300w, https://blog.jonthan.xyz/media/posts/12/responsive/telegr-sm.png 480w, https://blog.jonthan.xyz/media/posts/12/responsive/telegr-md.png 768w, https://blog.jonthan.xyz/media/posts/12/responsive/telegr-lg.png 1024w, https://blog.jonthan.xyz/media/posts/12/responsive/telegr-xl.png 1360w, https://blog.jonthan.xyz/media/posts/12/responsive/telegr-2xl.png 1600w"><figcaption>Setting a bot is as simple as this.</figcaption></figure><p>The next step is to setup a group where you want your alerts to go and add yourself, the bot you just created and <a href="https://t.me/myidbot" target="_blank" rel="nofollow noopener">IDbot</a>.</p><p>IDBot will give you the CHATID. You can do this by sending "<i>/getgroupid"&nbsp;</i>into the group. It'll return the group ID for the channel, simply prepend a hyphen to the number and that's the chatID: <i>-123456789</i> as an example. Grab this, plus the HTTP API key of your own bot, and add them to the following script:</p><pre class="line-numbers language-bash"><code># Login Notifications
CHATID=CHANGEME
BOTKEY=CHANGEME

# get hostname
HOSTNM=$( hostname )

# get external IP address
IP=$( curl -s http://whatismyip.akamai.com/ )

# find IP address of person last logged in
LOGININFO=$( last -1 -i | head -n 1)

# parse into nice format
LOGININFO1=$( python3 -c "login='$LOGININFO'.split('   '); del login[1]; del login[1]; print(''.join([x.strip(' ') + '   \n' for x in login]));" )

# send information to telegram notification bot
curl -X POST -H 'Content-Type: application/json' -d "{\"chat_id\": \"$CHATID\", \"text\": \"Log in to: $HOSTNM\n$IP\nfrom: $LOGININFO1\", \"disable_notification\": false}" https://api.telegram.org/bot$BOTKEY/sendMessage --silent &gt; /dev/null</code></pre><p>This can then either be bundled into a bash script and called from your profile or written straight into the profile:</p><ul><li>If your shell is ZSH:&nbsp;</li></ul><pre class="line-numbers language-bash"><code>nano /etc/zsh/zprofile</code></pre><ul><li>If your shell is Bash:</li></ul><pre class="line-numbers language-bash"><code>  nano /etc/profile</code></pre><h2 id="slack-notification">Slack notification</h2><p>You will need a Slack webhook. <a href="https://api.slack.com/messaging/webhooks" target="_blank" rel="nofollow noopener">Here</a> is the documentation about creating one.</p><p>After getting a webhook, you should have a URL like this one:</p><div>https://hooks.slack.com/services/VALUE1/VALUE2</div><p>To get a Slack notification I will use a python script.&nbsp;For this reason, you need to: install python, install the Slack SDK and write the script.</p><pre class="line-numbers language-bash"><code>sudo apt update
sudo apt install python3
pip install slack_sdk    
nano notification.py</code></pre><p>The content of <b>notification.py</b> must be the following:</p><pre class="line-numbers language-python"><code>from slack_sdk.webhook import WebhookClient
import os

url = " https://hooks.slack.com/services/VALUE1/VALUE2"
webhook = WebhookClient(url)
HOSTNM = os.popen('hostname').read()
IP = os.popen('curl -s http://whatismyip.akamai.com/').read()
LOGININFO=os.popen('last -1 -i | head -n 1 | cut -d " " -f 1').read()

response = webhook.send(text='Log in to: {}\n from {}\n by\n User: {} \n'.format(HOSTNM,IP,LOGININFO))
assert response.status_code == 200
assert response.body == "ok"</code></pre><p>Save the changes, then run the script just for testing purposes:</p><pre class="line-numbers language-bash"><code>python3 /path/to/the/file/notification.py</code></pre><p>Then, after checking that the script runs flawlessly, add the command at the end of your profile, the same way you would add the telegram bash script to your profile, depending of the shell you're using.</p><p>And that's it, now you should be receiving notifications on Telegram or Slack everytime someone enters your server.</p><h3 id="credits">Credits</h3><p>Credits to <a href="https://blog.zsec.uk/" target="_blank" rel="nofollow noopener">ZeroSec</a> for this info.</p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on August 31, 2022</p><ul class="post__tag"><li><a href="https://blog.jonthan.xyz/blog/self-hosted/">Self-hosted</a></li></ul><div class="post__share"></div><div class="post__bio bio"><div class="bio__info"><h3 class="bio__name"><a href="https://blog.jonthan.xyz/jonathan/jonathan-rodenas-lopez/" rel="author">Jonathan Ródenas López</a></h3></div></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://blog.jonthan.xyz/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://blog.jonthan.xyz/how-to-configure-ssh-to-be-secure/" class="post__nav-link" rel="prev"><span>Previous</span> How to install and configure SSH to be secure</a></div><div class="post__nav-next"><a href="https://blog.jonthan.xyz/self-hosting-guide/" class="post__nav-link" rel="next"><span>Next</span> Self-Hosting Guide </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://blog.jonthan.xyz/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2022-09-16T17:42" class="feed__date">September 16, 2022</time></div><h3 class="h1"><a href="https://blog.jonthan.xyz/how-to-build-a-docker-media-server/">How to mount a torrent server to watch movies and series for free</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2022-08-31T04:20" class="feed__date">August 31, 2022</time></div><h3 class="h1"><a href="https://blog.jonthan.xyz/how-to-clean-your-docker/">How to clean your Docker.</a></h3></article></div></div></main><footer class="footer"><script defer="defer" src="https://blog.jonthan.xyz/assets/js/prism.js?v=f745a05992777ae78ef04e93948dd9d2"></script><div class="footer__social"><a href="https://twitter.com/Baronhez1" aria-label="Twitter"><svg><use xlink:href="https://blog.jonthan.xyz/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.linkedin.com/in/jonathanrodenaslopez/" aria-label="LinkedIn"><svg><use xlink:href="https://blog.jonthan.xyz/assets/svg/svg-map.svg#linkedin"/></svg></a></div><div class="footer__copyright"><h5><span style="color: #ffffff;">Thanks for coming!</span></h5></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg><use xlink:href="https://blog.jonthan.xyz/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script defer="defer" src="https://blog.jonthan.xyz/assets/js/scripts.min.js?v=f47c11534595205f20935f0db2a62a85"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');

        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script src="https://blog.jonthan.xyz/media/plugins/docSearch/docsearch.min.js"></script><script type="text/javascript">docsearch({
				container: '#docsearch',
				appId: 'Z3L7HF3NXL',
				indexName: 'baronhez',
				apiKey: 'a2bb1c3cbab14ad1bce47fca85b5601a',
				debug: false
			});</script></body></html>